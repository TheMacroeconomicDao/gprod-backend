# Руководство по внесению изменений в GPROD Backend

## Соглашения по коммитам

Проект использует [Conventional Commits](https://www.conventionalcommits.org/) для структурирования сообщений коммитов, что обеспечивает ясную историю изменений и автоматизацию формирования чейнджлогов.

### Формат коммита

```
<тип>[опциональная область]: <описание>

[опциональное тело]

[опциональный футер]
```

### Типы коммитов

| Тип | Описание |
|-----|----------|
| `feat` | Новая функциональность |
| `fix` | Исправление ошибки |
| `docs` | Изменения в документации |
| `style` | Изменения форматирования (пробелы, отступы) |
| `refactor` | Рефакторинг кода без изменения функциональности |
| `perf` | Улучшения производительности |
| `test` | Добавление или исправление тестов |
| `build` | Изменения в процессе сборки |
| `ci` | Изменения в CI/CD |
| `chore` | Другие изменения, не затрагивающие код |
| `ai` | Изменения, связанные с интеграцией ИИ |

### Примеры коммитов

```
feat(auth): добавлена поддержка двухфакторной аутентификации

fix(api): исправлена ошибка при отправке запроса к API

docs: обновлена документация по установке

refactor(users): переработка сервиса управления пользователями
```

## Процесс разработки

### 1. Подготовка к разработке

```bash
# Клонирование репозитория
git clone https://github.com/TheMacroeconomicDao/gprod-backend.git
cd gprod-backend

# Установка зависимостей
pnpm install

# Настройка окружения
pnpm run env:setup
pnpm run env:switch dev
```

### 2. Создание новой функциональности

```bash
# Создание ветки
git checkout -b feature/my-feature

# Разработка...

# Запуск тестов
pnpm run test:smart
```

### 3. Подготовка изменений к коммиту

1. Убедитесь, что соблюдаются стандарты кода
2. Проверьте, что все тесты проходят
3. Обновите документацию, если необходимо

### 4. Создание Pull Request

1. Отправьте ветку в репозиторий: `git push origin feature/my-feature`
2. Создайте Pull Request в GitHub
3. Укажите подробное описание изменений
4. Дождитесь проверки и одобрения от других разработчиков

## Стандарты кода

### TypeScript

- Используйте строгую типизацию
- Избегайте `any` типа
- Используйте интерфейсы для определения структуры данных
- Применяйте `readonly` для неизменяемых свойств

### NestJS

- Следуйте модульной архитектуре
- Используйте декораторы для маршрутов и параметров
- Разделяйте логику на контроллеры и сервисы
- Применяйте DTO для валидации входных данных

### Тестирование

- Пишите unit-тесты для каждой публичной функции
- Создавайте тестовые дублеры для внешних зависимостей
- Поддерживайте покрытие кода тестами на уровне не менее 80%

## Семантическое версионирование

Проект следует принципам [Semantic Versioning](https://semver.org/):

- **MAJOR** (1.0.0): Несовместимые изменения API
- **MINOR** (0.1.0): Новая функциональность с обратной совместимостью
- **PATCH** (0.0.1): Исправления ошибок с обратной совместимостью

## Чеклист для Pull Request

- [ ] Код соответствует стандартам
- [ ] Все тесты проходят успешно
- [ ] Добавлены новые тесты для новой функциональности
- [ ] Документация обновлена
- [ ] Коммиты соответствуют Conventional Commits
- [ ] Обновлены зависимости, если необходимо

## Интеграция с CI/CD

При создании Pull Request автоматически запускаются:

1. Линтинг кода
2. Сборка проекта
3. Запуск unit-тестов
4. Запуск e2e-тестов
5. Проверка форматирования кода

## Контакты для вопросов

Если у вас возникли вопросы по процессу внесения изменений, обратитесь к:

- Техническому лиду проекта
- DevOps инженеру (для вопросов, связанных с инфраструктурой)
- Создайте Issue в репозитории с меткой "question"
