# –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤ GPROD Backend

## –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –û–±–∑–æ—Ä

–°–∫—Ä–∏–ø—Ç `interactive-run.sh` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å –≤—ã–±–æ—Ä–æ–º –∫–æ–Ω—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Ä–µ–∂–∏–º–∞ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ –º–µ–Ω—é, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

### –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ pnpm
pnpm run auto:interactive

# –ò–ª–∏ –ø—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
./automation/scripts/interactive-run.sh
```

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é:

```
üöÄ GPROD –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫

–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç—É—Ä:
  1) Development (dev) - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
  2) Staging (stage) - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  3) Production (prod) - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
  4) Reference - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–†–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞:
  a) –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
  b) –° –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏:
  q) –í—ã—Ö–æ–¥

–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1a –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ dev): 
```

–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥:
- `1a` - dev –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
- `1b` - dev —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
- `2a` - stage –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
- `3b` - prod —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
- `4a` - reference –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ

## –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

–°–∫—Ä–∏–ø—Ç `docker-test-runner.sh` –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤ Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–∏.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç–∞

- –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤
- –ó–∞–ø—É—Å–∫ unit –∏ e2e —Ç–µ—Å—Ç–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –≤ Docker
pnpm run docker:test:all

# –ó–∞–ø—É—Å–∫ —Å —á–∏—Å—Ç—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
pnpm run docker:test:clean

# –¢–æ–ª—å–∫–æ unit-—Ç–µ—Å—Ç—ã
pnpm run docker:test:unit

# –¢–æ–ª—å–∫–æ e2e-—Ç–µ—Å—Ç—ã
pnpm run docker:test:e2e
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω—ã .env —Ñ–∞–π–ª–æ–≤
pnpm run env:setup

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –æ–∫—Ä—É–∂–µ–Ω–∏—è
pnpm run env:switch:new

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
pnpm run env:dev:new        # development
pnpm run env:stage:new      # staging
pnpm run env:prod:new       # production
```

## –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è Docker

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç—É—Ä–æ–≤

```bash
# Development
pnpm run docker:dev          # –ó–∞–ø—É—Å—Ç–∏—Ç—å
pnpm run docker:dev:build    # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
pnpm run docker:dev:stop     # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

# Staging
pnpm run docker:stage        # –ó–∞–ø—É—Å—Ç–∏—Ç—å
pnpm run docker:stage:build  # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
pnpm run docker:stage:stop   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

# Production
pnpm run docker:prod         # –ó–∞–ø—É—Å—Ç–∏—Ç—å
pnpm run docker:prod:build   # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
pnpm run docker:prod:stop    # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

# Reference (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
pnpm run docker:reference    # –ó–∞–ø—É—Å—Ç–∏—Ç—å
pnpm run docker:reference:build # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
pnpm run docker:reference:down  # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```bash
# –ú–∏–≥—Ä–∞—Ü–∏–∏ Prisma –≤ Docker
pnpm run docker:prisma:migrate:dev    # –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è development
pnpm run docker:prisma:migrate:stage  # –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è staging
pnpm run docker:prisma:migrate:prod   # –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è production

# Prisma Studio
pnpm run docker:prisma:studio:dev     # –ó–∞–ø—É—Å–∫ Prisma Studio
```

## –î—Ä—É–≥–∏–µ –ø–æ–ª–µ–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ docker-manager.sh

```bash
# –°–∏–Ω—Ç–∞–∫—Å–∏—Å
./docker/docker-manager.sh <–∫–æ–Ω—Ç—É—Ä> <–∫–æ–º–∞–Ω–¥–∞> [--build]

# –ü—Ä–∏–º–µ—Ä—ã
./docker/docker-manager.sh dev up          # –ó–∞–ø—É—Å—Ç–∏—Ç—å development
./docker/docker-manager.sh stage down      # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å staging
./docker/docker-manager.sh prod restart    # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å production
./docker/docker-manager.sh reference logs  # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ reference
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
pnpm run auto:logs:dev        # –õ–æ–≥–∏ development
pnpm run auto:logs:stage      # –õ–æ–≥–∏ staging
pnpm run auto:logs:prod       # –õ–æ–≥–∏ production

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Grafana –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º URL)
pnpm run docker:stage:monitor # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ staging
pnpm run docker:prod:monitor  # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ production
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

```
automation/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ docker-test-runner.sh  # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ Docker
‚îÇ   ‚îú‚îÄ‚îÄ interactive-run.sh     # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ run.sh                 # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç—É—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ env-manager.sh         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏
‚îÇ
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ .env.development       # –®–∞–±–ª–æ–Ω –¥–ª—è development
‚îÇ   ‚îú‚îÄ‚îÄ .env.staging           # –®–∞–±–ª–æ–Ω –¥–ª—è staging
‚îÇ   ‚îú‚îÄ‚îÄ .env.production        # –®–∞–±–ª–æ–Ω –¥–ª—è production
‚îÇ   ‚îî‚îÄ‚îÄ .env.test              # –®–∞–±–ª–æ–Ω –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```
