# GPROD Backend (Gybernaty Community)

**Production-ready –±—ç–∫–µ–Ω–¥ –Ω–∞ NestJS + Prisma + PostgreSQL + pnpm + Docker**

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

![–í–µ—Ä—Å–∏—è](https://img.shields.io/badge/–≤–µ—Ä—Å–∏—è-1.0.0-blue)
![–°—Ç–∞—Ç—É—Å](https://img.shields.io/badge/—Å—Ç–∞—Ç—É—Å-–∞–∫—Ç–∏–≤–Ω–∞—è_—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-green)
![–¢–µ—Å—Ç—ã](https://img.shields.io/badge/—Ç–µ—Å—Ç—ã-–ø—Ä–æ—Ö–æ–¥—è—Ç-success)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|-----------|--------|----------|
| API v1 | ‚úÖ –†–µ–ª–∏–∑ | 100% |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | ‚úÖ –†–µ–ª–∏–∑ | 100% |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | ‚úÖ –†–µ–ª–∏–∑ | 100% |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ | ‚úÖ –†–µ–ª–∏–∑ | 100% |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ | ‚úÖ –†–µ–ª–∏–∑ | 100% |
| API v2 | ‚è≥ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ | 40% |
| –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ | 0% |

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/TheMacroeconomicDao/gprod-backend.git
cd gprod-backend
pnpm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
pnpm run env:setup
pnpm run env:switch dev

# –ó–∞–ø—É—Å–∫ –≤ Docker
pnpm run auto:interactive
```

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—á–∏

- ‚úÖ **–¢—Ä–∏ –∫–æ–Ω—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è** - dev, stage, prod
- ‚úÖ **–†–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø** - RBAC —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- ‚úÖ **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –ë–î
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API** - Swagger –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - Grafana + Prometheus

## –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

- **[gprod-backend](https://github.com/TheMacroeconomicDao/gprod-backend)** - –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **[gybernaty-infra](https://github.com/TheMacroeconomicDao/gybernaty-infra)** - –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
pnpm run auto:interactive

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
pnpm run auto:run:dev
pnpm run docker:reference

# –ü—Ä–æ–¥–∞–∫—à–Ω
pnpm run auto:run:prod
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –≤ Docker
pnpm run docker:test:all

# –ó–∞–ø—É—Å–∫ —Å —á–∏—Å—Ç—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
pnpm run docker:test:clean
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ [docs/](docs/README.md)

### üìä –°—Ç–∞—Ç—É—Å –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- [üó∫Ô∏è –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞](docs/ROADMAP.md) - –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- [üìà –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å](docs/STATUS.md) - –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ 
- [üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π](docs/CHANGELOG.md) - –ñ—É—Ä–Ω–∞–ª –≤–µ—Ä—Å–∏–π

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –¥–∏–∑–∞–π–Ω
- [üèõÔ∏è –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](docs/architecture/README.md) - –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [üß© –ú–æ–¥—É–ª–∏](docs/architecture/modules.md) - –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üë®‚Äçüíª –ü—Ä–æ—Ü–µ—Å—Å—ã
- [üìã –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](docs/development/README.md) - –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](docs/testing/README.md) - –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [üê≥ Docker](docs/docker/README.md) - Docker-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **NestJS** ‚Äî –º–æ–¥—É–ª—å–Ω—ã–π –±—ç–∫–µ–Ω–¥-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
- **TypeScript** ‚Äî —Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **Prisma ORM** ‚Äî —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π ORM —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- **PostgreSQL** ‚Äî –Ω–∞–¥—ë–∂–Ω–∞—è –°–£–ë–î
- **Docker & docker-compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Swagger** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **JWT** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Winston** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Jest** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Prometheus & Grafana** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## –õ–∏—Ü–µ–Ω–∑–∏—è

AGPL-3.0

## ‚ö°Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (env)

- –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ .env ‚Äî –æ–Ω –≤—Å–µ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã –≤ `automation/env/`.
- –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
  - `env-manager.sh`: –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–∏–µ –Ω—É–∂–Ω–æ–≥–æ .env.<env>, —Å–∏–º–ª–∏–Ω–∫ .env, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏.
  - `env-switch-new.sh`: –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å, OS detection, –∞–¥–∞–ø—Ç–∞—Ü–∏—è DATABASE_URL, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ docker-compose, —Å–æ–∑–¥–∞–Ω–∏–µ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤.
  - `setup-env-files.sh`: –º–∞—Å—Å–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤ .env –¥–ª—è –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä.
- –î–ª—è –ª—é–±–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å .env —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π.
- –°–∏–º–ª–∏–Ω–∫ `.env` –≤—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π .env.<env>.
- –î–ª—è CI/CD, Docker, –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Äî –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–∑ `automation/env/`.
- –ï—Å–ª–∏ .env –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –µ–≥–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥–æ–π:
  ```sh
  ./automation/env/env-manager.sh dev
  # –∏–ª–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
  ./automation/env/env-switch-new.sh
  ```
- –°–∫—Ä–∏–ø—Ç—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥ Docker/–ª–æ–∫–∞–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, DATABASE_URL).
- –î–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π:
  ```sh
  ./automation/env/env-manager.sh dev --docker
  ```
- –ï—Å–ª–∏ –Ω—É–∂–µ–Ω .env –¥–ª—è CI ‚Äî –¥–æ–±–∞–≤—å —à–∞–≥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ .env —á–µ—Ä–µ–∑ —ç—Ç–∏ —Å–∫—Ä–∏–ø—Ç—ã –≤ pipeline.